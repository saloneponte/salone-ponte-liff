<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Salone Ponte çµ±åˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .tab-active {
      @apply bg-blue-500 text-white border-blue-500;
    }
    
    .tag {
      @apply inline-block px-2 py-1 text-xs rounded-full;
    }
    .tag-vip { @apply bg-purple-100 text-purple-800; }
    .tag-regular { @apply bg-green-100 text-green-800; }
    .tag-new { @apply bg-blue-100 text-blue-800; }
    .tag-risk { @apply bg-red-100 text-red-800; }
    .tag-custom { @apply bg-gray-100 text-gray-800; }
    
    .modal {
      @apply fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50;
    }
    
    .modal.active {
      @apply flex;
    }

    .side-nav {
      @apply fixed left-0 top-0 h-full w-64 bg-gray-900 text-white transform -translate-x-full transition-transform duration-300 z-40;
    }

    .side-nav.active {
      @apply translate-x-0;
    }

    .main-content {
      @apply transition-all duration-300;
    }

    .main-content.shifted {
      @apply ml-64;
    }

    .menu-overlay {
      @apply fixed inset-0 bg-black bg-opacity-50 hidden z-30;
    }

    .menu-overlay.active {
      @apply block;
    }

    @media (max-width: 768px) {
      .main-content.shifted {
        @apply ml-0;
      }
    }

    .message-thread {
      max-height: 400px;
      overflow-y: auto;
    }

    .message-item {
      @apply mb-3 p-3 rounded-lg;
    }

    .message-sent {
      @apply bg-blue-100 ml-8;
    }

    .message-received {
      @apply bg-gray-100 mr-8;
    }

    .online-indicator {
      @apply w-3 h-3 bg-green-400 rounded-full absolute -top-1 -right-1;
    }

    .chat-list-item {
      @apply p-3 border-b border-gray-200 cursor-pointer hover:bg-gray-50 transition-colors;
    }

    .chat-list-item.active {
      @apply bg-blue-50 border-blue-200;
    }

    .unread-badge {
      @apply bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- ã‚µã‚¤ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
  <nav id="sideNav" class="side-nav">
    <div class="p-6">
      <h2 class="text-xl font-bold mb-6">ğŸ’‡â€â™€ï¸ Salone Ponte</h2>
      <ul class="space-y-2">
        <li>
          <button onclick="switchTab('dashboard')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors">
            ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
          </button>
        </li>
        <li>
          <button onclick="switchTab('customers')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors">
            ğŸ‘¥ é¡§å®¢ç®¡ç†
          </button>
        </li>
        <li>
          <button onclick="switchTab('reservations')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors">
            ğŸ“… äºˆç´„ç®¡ç†
          </button>
        </li>
        <li>
          <button onclick="switchTab('menu-staff')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors">
            âš™ï¸ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ»ã‚¹ã‚¿ãƒƒãƒ•
          </button>
        </li>
        <li>
          <button onclick="switchTab('counseling')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors">
            ğŸ“‹ ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°
          </button>
        </li>
        <li>
          <button onclick="switchTab('messaging')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors relative">
            ğŸ’¬ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡
            <span id="messageNotification" class="unread-badge hidden absolute top-1 right-1">0</span>
          </button>
        </li>
        <li>
          <button onclick="switchTab('analytics')" class="nav-item w-full text-left px-4 py-2 rounded hover:bg-gray-800 transition-colors">
            ğŸ“ˆ å£²ä¸Šåˆ†æ
          </button>
        </li>
      </ul>
    </div>
  </nav>

  <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆãƒ¢ãƒã‚¤ãƒ«ç”¨ï¼‰ -->
  <div id="menuOverlay" class="menu-overlay" onclick="closeSideNav()"></div>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div id="mainContent" class="main-content">
    <!-- ãƒˆãƒƒãƒ—ãƒãƒ¼ -->
    <div class="bg-white shadow-sm border-b border-gray-200 px-6 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center">
          <button id="menuToggle" class="md:hidden mr-4 p-2" onclick="toggleSideNav()">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
          <h1 id="pageTitle" class="text-2xl font-bold text-gray-800">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        </div>
        <div class="flex items-center space-x-4">
          <button onclick="openBookingPage()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
            ğŸ“… äºˆç´„ç”»é¢ã‚’é–‹ã
          </button>
          <div class="flex items-center space-x-2">
            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
              <span class="text-white text-sm font-medium">ç®¡</span>
            </div>
            <span class="text-sm font-medium">ç®¡ç†è€…</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
    <div class="p-6">
      <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ– -->
      <div id="dashboardTab" class="tab-content">
        <!-- çµ±è¨ˆã‚µãƒãƒªãƒ¼ -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center">
              <div class="p-3 rounded-full bg-blue-100 text-blue-600">ğŸ‘¥</div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">ç·é¡§å®¢æ•°</p>
                <p class="text-2xl font-semibold text-gray-900" id="totalCustomers">0</p>
              </div>
            </div>
          </div>
          
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center">
              <div class="p-3 rounded-full bg-green-100 text-green-600">ğŸ“…</div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">ä»Šæœˆäºˆç´„</p>
                <p class="text-2xl font-semibold text-gray-900" id="monthlyReservations">0</p>
              </div>
            </div>
          </div>
          
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center">
              <div class="p-3 rounded-full bg-purple-100 text-purple-600">ğŸ’°</div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">ä»Šæœˆå£²ä¸Š</p>
                <p class="text-2xl font-semibold text-gray-900" id="monthlyRevenue">Â¥0</p>
              </div>
            </div>
          </div>
          
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center">
              <div class="p-3 rounded-full bg-red-100 text-red-600">âš ï¸</div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">è¦ãƒ•ã‚©ãƒ­ãƒ¼</p>
                <p class="text-2xl font-semibold text-gray-900" id="needFollowUp">0</p>
              </div>
            </div>
          </div>
        </div>

        <!-- æœ€è¿‘ã®äºˆç´„ -->
        <div class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-lg font-semibold mb-4">æœ€è¿‘ã®äºˆç´„</h3>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">æ—¥æ™‚</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">é¡§å®¢</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ã‚¹ã‚¿ãƒƒãƒ•</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">é‡‘é¡</th>
                </tr>
              </thead>
              <tbody id="recentReservations" class="bg-white divide-y divide-gray-200">
                <!-- ãƒ‡ãƒ¼ã‚¿ã¯ JavaScript ã§å‹•çš„ã«ç”Ÿæˆ -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- é¡§å®¢ç®¡ç†ã‚¿ãƒ– -->
      <div id="customersTab" class="tab-content hidden">
        <!-- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">é¡§å®¢æ¤œç´¢</label>
              <input type="text" id="customerSearch" placeholder="åå‰ãƒ»é›»è©±ç•ªå·ã§æ¤œç´¢" 
                     class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¿ã‚°çµã‚Šè¾¼ã¿</label>
              <select id="customerTagFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">å…¨ã¦</option>
                <option value="VIPé¡§å®¢">VIPé¡§å®¢</option>
                <option value="å¸¸é€£é¡§å®¢">å¸¸é€£é¡§å®¢</option>
                <option value="æ–°è¦é¡§å®¢">æ–°è¦é¡§å®¢</option>
                <option value="é›¢åãƒªã‚¹ã‚¯">é›¢åãƒªã‚¹ã‚¯</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">æ¥åº—æœŸé–“</label>
              <select id="customerVisitFilter" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">å…¨æœŸé–“</option>
                <option value="30">30æ—¥ä»¥å†…</option>
                <option value="60">60æ—¥ä»¥å†…</option>
                <option value="90">90æ—¥ä»¥å†…</option>
                <option value="180">180æ—¥ä»¥ä¸Š</option>
              </select>
            </div>
            <div class="flex items-end space-x-2">
              <button onclick="applyCustomerFilters()" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">
                æ¤œç´¢
              </button>
              <button onclick="resetCustomerFilters()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors">
                ãƒªã‚»ãƒƒãƒˆ
              </button>
            </div>
          </div>
        </div>

        <!-- é¡§å®¢ä¸€è¦§ -->
        <div class="bg-white rounded-lg shadow-md">
          <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-900">é¡§å®¢ä¸€è¦§</h3>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">é¡§å®¢æƒ…å ±</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ã‚¿ã‚°</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ¥åº—æƒ…å ±</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ç´¯è¨ˆé‡‘é¡</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœ€çµ‚æ¥åº—</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="customersTable" class="bg-white divide-y divide-gray-200">
                <!-- é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã¯ JavaScript ã§å‹•çš„ã«ç”Ÿæˆ -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- äºˆç´„ç®¡ç†ã‚¿ãƒ– -->
      <div id="reservationsTab" class="tab-content hidden">
        <div class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-lg font-semibold mb-4">äºˆç´„ç®¡ç†</h3>
          
          <!-- äºˆç´„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
          <div class="flex flex-wrap gap-4 mb-6">
            <select id="reservationDateFilter" class="px-3 py-2 border border-gray-300 rounded-md">
              <option value="today">ä»Šæ—¥</option>
              <option value="tomorrow">æ˜æ—¥</option>
              <option value="week">ä»Šé€±</option>
              <option value="month">ä»Šæœˆ</option>
            </select>
            <select id="reservationStaffFilter" class="px-3 py-2 border border-gray-300 rounded-md">
              <option value="">å…¨ã‚¹ã‚¿ãƒƒãƒ•</option>
            </select>
            <select id="reservationStatusFilter" class="px-3 py-2 border border-gray-300 rounded-md">
              <option value="">å…¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
              <option value="confirmed">ç¢ºå®š</option>
              <option value="completed">å®Œäº†</option>
              <option value="cancelled">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option>
            </select>
            <button onclick="applyReservationFilters()" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
              ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
            </button>
          </div>
          
          <!-- äºˆç´„ä¸€è¦§ -->
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">æ—¥æ™‚</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">é¡§å®¢</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ã‚¹ã‚¿ãƒƒãƒ•</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">é‡‘é¡</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="reservationsTable" class="bg-white divide-y divide-gray-200">
                <!-- äºˆç´„ãƒ‡ãƒ¼ã‚¿ã¯ JavaScript ã§å‹•çš„ã«ç”Ÿæˆ -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ»ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†ã‚¿ãƒ– -->
      <div id="menuStaffTab" class="tab-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç† -->
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-semibold">ğŸ½ï¸ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç†</h3>
              <button onclick="openMenuModal()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                + æ–°è¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼
              </button>
            </div>
            <div id="menuList" class="space-y-4">
              <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒªã‚¹ãƒˆã¯ JavaScript ã§ç”Ÿæˆ -->
            </div>
          </div>

          <!-- ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç† -->
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-semibold">ğŸ‘©â€ğŸ’¼ ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†</h3>
              <button onclick="openStaffModal()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                + æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•
              </button>
            </div>
            <div id="staffList" class="space-y-4">
              <!-- ã‚¹ã‚¿ãƒƒãƒ•ãƒªã‚¹ãƒˆã¯ JavaScript ã§ç”Ÿæˆ -->
            </div>
          </div>
        </div>

        <!-- å–¶æ¥­è¨­å®š -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
          <h3 class="text-lg font-semibold mb-4">ğŸ• å–¶æ¥­æ™‚é–“ãƒ»ä¼‘æ¥­æ—¥è¨­å®š</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-medium mb-3">å–¶æ¥­æ™‚é–“</h4>
              <div class="space-y-3">
                <div class="flex items-center space-x-4">
                  <span class="w-16 text-sm">å¹³æ—¥:</span>
                  <input type="time" id="weekdayOpen" value="10:00" class="px-3 py-2 border border-gray-300 rounded-md">
                  <span>ã€œ</span>
                  <input type="time" id="weekdayClose" value="19:00" class="px-3 py-2 border border-gray-300 rounded-md">
                </div>
                <div class="flex items-center space-x-4">
                  <span class="w-16 text-sm">åœŸæ—¥:</span>
                  <input type="time" id="weekendOpen" value="10:00" class="px-3 py-2 border border-gray-300 rounded-md">
                  <span>ã€œ</span>
                  <input type="time" id="weekendClose" value="18:00" class="px-3 py-2 border border-gray-300 rounded-md">
                </div>
              </div>
            </div>
            <div>
              <h4 class="font-medium mb-3">å®šä¼‘æ—¥</h4>
              <div class="grid grid-cols-2 gap-2">
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedSunday" checked class="rounded">
                  <span class="text-sm">æ—¥æ›œæ—¥</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedMonday" class="rounded">
                  <span class="text-sm">æœˆæ›œæ—¥</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedTuesday" class="rounded">
                  <span class="text-sm">ç«æ›œæ—¥</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedWednesday" class="rounded">
                  <span class="text-sm">æ°´æ›œæ—¥</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedThursday" class="rounded">
                  <span class="text-sm">æœ¨æ›œæ—¥</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedFriday" class="rounded">
                  <span class="text-sm">é‡‘æ›œæ—¥</span>
                </label>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="closedSaturday" class="rounded">
                  <span class="text-sm">åœŸæ›œæ—¥</span>
                </label>
              </div>
            </div>
          </div>
          <button onclick="saveBusinessSettings()" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
            å–¶æ¥­è¨­å®šã‚’ä¿å­˜
          </button>
        </div>
      </div>

      <!-- ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã‚¿ãƒ– -->
      <div id="counselingTab" class="tab-content hidden">
        <div class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-lg font-semibold mb-4">ğŸ“‹ ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã‚·ãƒ¼ãƒˆç®¡ç†</h3>
          
          <!-- ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã‚·ãƒ¼ãƒˆä¸€è¦§ -->
          <div class="mb-6">
            <div class="flex justify-between items-center mb-4">
              <h4 class="font-medium">æœªå®Ÿæ–½ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°</h4>
              <button onclick="createCounselingTemplate()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                + ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ
              </button>
            </div>
            <div id="pendingCounseling" class="space-y-4">
              <!-- æœªå®Ÿæ–½ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆ -->
            </div>
          </div>

          <!-- å®Œäº†æ¸ˆã¿ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚° -->
          <div>
            <h4 class="font-medium mb-4">å®Œäº†æ¸ˆã¿ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°</h4>
            <div id="completedCounseling" class="space-y-4">
              <!-- å®Œäº†æ¸ˆã¿ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆ -->
            </div>
          </div>
        </div>
      </div>

      <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡ã‚¿ãƒ– -->
      <div id="messagingTab" class="tab-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- é¡§å®¢ãƒªã‚¹ãƒˆ -->
          <div class="bg-white rounded-lg shadow-md">
            <div class="p-4 border-b border-gray-200">
              <h3 class="text-lg font-semibold">é¡§å®¢ãƒªã‚¹ãƒˆ</h3>
              <div class="mt-2">
                <input type="text" id="chatSearch" placeholder="é¡§å®¢æ¤œç´¢..." 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
              </div>
            </div>
            <div id="chatList" class="max-h-96 overflow-y-auto">
              <!-- é¡§å®¢ãƒãƒ£ãƒƒãƒˆãƒªã‚¹ãƒˆ -->
            </div>
          </div>

          <!-- ãƒãƒ£ãƒƒãƒˆç”»é¢ -->
          <div class="lg:col-span-2 bg-white rounded-lg shadow-md flex flex-col">
            <div id="chatHeader" class="p-4 border-b border-gray-200 bg-gray-50">
              <div class="flex items-center">
                <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-medium mr-3">
                  é¡§
                </div>
                <div>
                  <h4 class="font-medium">é¡§å®¢ã‚’é¸æŠã—ã¦ãã ã•ã„</h4>
                  <p class="text-sm text-gray-500">å·¦ã®ä¸€è¦§ã‹ã‚‰é¡§å®¢ã‚’é¸æŠã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é–‹å§‹</p>
                </div>
              </div>
            </div>
            
            <div id="chatMessages" class="flex-1 p-4 message-thread">
              <div class="text-center text-gray-500">
                é¡§å®¢ã‚’é¸æŠã—ã¦ãã ã•ã„
              </div>
            </div>
            
            <div id="chatInput" class="p-4 border-t border-gray-200" style="display: none;">
              <div class="flex space-x-2">
                <input type="text" id="messageInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." 
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md">
                <button onclick="sendMessage()" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
                  é€ä¿¡
                </button>
              </div>
              
              <!-- ã‚¯ã‚¤ãƒƒã‚¯è¿”ä¿¡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
              <div class="mt-3">
                <div class="text-sm text-gray-600 mb-2">ã‚¯ã‚¤ãƒƒã‚¯è¿”ä¿¡:</div>
                <div class="flex flex-wrap gap-2">
                  <button onclick="insertQuickReply('ã”äºˆç´„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å½“æ—¥ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚')" 
                          class="text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200">
                    äºˆç´„ç¢ºèª
                  </button>
                  <button onclick="insertQuickReply('ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€‚ã¾ãŸã®ã”æ¥åº—ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚')" 
                          class="text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200">
                    æ–½è¡“å¾Œ
                  </button>
                  <button onclick="insertQuickReply('ãŠä¹…ã—ã¶ã‚Šã§ã™ã€‚ã„ã‹ãŒãŠéã”ã—ã§ã—ã‚‡ã†ã‹ï¼Ÿ')" 
                          class="text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200">
                    ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

                    <!-- ä¸€æ‹¬é…ä¿¡è¨­å®š -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
          <h3 class="text-lg font-semibold mb-4">ğŸ“¢ ä¸€æ‹¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡</h3>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">é…ä¿¡å¯¾è±¡</label>
                  <select id="broadcastTarget" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="all">å…¨é¡§å®¢</option>
                    <option value="vip">VIPé¡§å®¢</option>
                    <option value="regular">å¸¸é€£é¡§å®¢</option>
                    <option value="new">æ–°è¦é¡§å®¢</option>
                    <option value="inactive">é›¢åãƒªã‚¹ã‚¯é¡§å®¢</option>
                    <option value="birthday">ä»Šæœˆèª•ç”Ÿæ—¥</option>
                    <option value="lastMonth">å…ˆæœˆæ¥åº—</option>
                  </select>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—</label>
                  <select id="messageType" onchange="loadMessageTemplate()" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="custom">ã‚«ã‚¹ã‚¿ãƒ </option>
                    <option value="reminder">æ¥åº—ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</option>
                    <option value="birthday">èª•ç”Ÿæ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</option>
                    <option value="campaign">ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å‘ŠçŸ¥</option>
                    <option value="seasonal">å­£ç¯€é™å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼</option>
                    <option value="followup">ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ã‚©ãƒ­ãƒ¼</option>
                  </select>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹</label>
                  <textarea id="broadcastMessage" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md" 
                            placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
                </div>

                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="scheduleMessage" class="rounded">
                  <label for="scheduleMessage" class="text-sm text-gray-700">äºˆç´„é…ä¿¡</label>
                </div>

                <div id="scheduleSettings" class="hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2">é…ä¿¡æ—¥æ™‚</label>
                  <input type="datetime-local" id="scheduleDateTime" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                </div>

                <div class="flex space-x-3">
                  <button onclick="previewBroadcast()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                    ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
                  </button>
                  <button onclick="sendBroadcast()" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                    é…ä¿¡å®Ÿè¡Œ
                  </button>
                </div>
              </div>
            </div>

            <div>
              <h4 class="font-medium mb-3">é…ä¿¡çµ±è¨ˆ</h4>
              <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-2xl font-bold text-blue-600" id="totalMessages">0</div>
                  <div class="text-sm text-gray-600">ç·é…ä¿¡æ•°</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                  <div class="text-2xl font-bold text-green-600" id="messageOpenRate">0%</div>
                  <div class="text-sm text-gray-600">é–‹å°ç‡</div>
                </div>
              </div>

              <h4 class="font-medium mb-3">æœ€è¿‘ã®é…ä¿¡</h4>
              <div id="messageHistory" class="space-y-3 max-h-64 overflow-y-auto">
                <!-- é…ä¿¡å±¥æ­´ã¯ JavaScript ã§ç”Ÿæˆ -->
              </div>
            </div>
          </div>
        </div>

        <!-- è‡ªå‹•é…ä¿¡è¨­å®š -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
          <h3 class="text-lg font-semibold mb-4">ğŸ¤– è‡ªå‹•é…ä¿¡è¨­å®š</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <h4 class="font-medium">äºˆç´„ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</h4>
                <input type="checkbox" id="autoReminder" class="rounded">
              </div>
              <p class="text-sm text-gray-600 mb-3">äºˆç´„å‰æ—¥ã«ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’è‡ªå‹•é€ä¿¡</p>
              <div class="space-y-2">
                <label class="block text-xs text-gray-500">é€ä¿¡æ™‚é–“</label>
                <input type="time" id="reminderTime" value="18:00" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">
              </div>
            </div>

            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <h4 class="font-medium">èª•ç”Ÿæ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</h4>
                <input type="checkbox" id="autoBirthday" class="rounded">
              </div>
              <p class="text-sm text-gray-600 mb-3">èª•ç”Ÿæ—¥å½“æ—¥ã«è‡ªå‹•ã§ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡</p>
              <div class="space-y-2">
                <label class="block text-xs text-gray-500">é€ä¿¡æ™‚é–“</label>
                <input type="time" id="birthdayTime" value="09:00" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">
              </div>
            </div>

            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-3">
                <h4 class="font-medium">é›¢åé˜²æ­¢</h4>
                <input type="checkbox" id="autoRetention" class="rounded">
              </div>
              <p class="text-sm text-gray-600 mb-3">90æ—¥æœªæ¥åº—ã®é¡§å®¢ã«è‡ªå‹•ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡</p>
              <div class="space-y-2">
                <label class="block text-xs text-gray-500">å®Ÿè¡Œé–“éš”</label>
                <select id="retentionInterval" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">
                  <option value="weekly">é€±1å›</option>
                  <option value="monthly">æœˆ1å›</option>
                </select>
              </div>
            </div>
          </div>
          
          <button onclick="saveAutoMessageSettings()" class="mt-6 bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
            è‡ªå‹•é…ä¿¡è¨­å®šã‚’ä¿å­˜
          </button>
        </div>
      </div>

      <!-- å£²ä¸Šåˆ†æã‚¿ãƒ– -->
      <div id="analyticsTab" class="tab-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- å£²ä¸Šã‚°ãƒ©ãƒ• -->
          <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4">ğŸ“ˆ æœˆåˆ¥å£²ä¸Šæ¨ç§»</h3>
            <canvas id="revenueChart" width="400" height="300"></canvas>
          </div>

          <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼åˆ¥å£²ä¸Š -->
          <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4">ğŸ½ï¸ ãƒ¡ãƒ‹ãƒ¥ãƒ¼åˆ¥å£²ä¸Š</h3>
            <canvas id="menuRevenueChart" width="400" height="300"></canvas>
          </div>
        </div>

        <!-- è©³ç´°çµ±è¨ˆ -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
          <h3 class="text-lg font-semibold mb-4">ğŸ“Š è©³ç´°çµ±è¨ˆ</h3>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div>
              <div class="text-2xl font-bold text-blue-600" id="avgTicket">Â¥0</div>
              <div class="text-sm text-gray-600">å¹³å‡å®¢å˜ä¾¡</div>
            </div>
            <div>
              <div class="text-2xl font-bold text-green-600" id="repeatRate">0%</div>
              <div class="text-sm text-gray-600">ãƒªãƒ”ãƒ¼ãƒˆç‡</div>
            </div>
            <div>
              <div class="text-2xl font-bold text-purple-600" id="customerLTV">Â¥0</div>
              <div class="text-sm text-gray-600">å¹³å‡LTV</div>
            </div>
            <div>
              <div class="text-2xl font-bold text-orange-600" id="growthRate">0%</div>
              <div class="text-sm text-gray-600">å‰æœˆæ¯”æˆé•·ç‡</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- é¡§å®¢è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="customerModal" class="modal">
    <div class="bg-white rounded-lg w-full max-w-4xl mx-4 max-h-full overflow-y-auto">
      <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h3 class="text-lg font-semibold text-gray-900" id="modalCustomerName">é¡§å®¢ã‚«ãƒ«ãƒ†</h3>
        <button id="closeCustomerModal" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <div class="p-6">
        <!-- ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã‚·ãƒ¼ãƒˆ -->
        <div class="bg-blue-50 p-4 rounded-lg mb-6">
          <h4 class="font-semibold mb-3">ğŸ“‹ ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã‚·ãƒ¼ãƒˆ</h4>
          <div id="customerCounseling">
            <!-- ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°å†…å®¹ã¯ JavaScript ã§ç”Ÿæˆ -->
          </div>
          <button onclick="openCounselingModal()" class="mt-3 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">
            ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°å®Ÿæ–½
          </button>
        </div>

        <!-- åŸºæœ¬æƒ…å ± -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="font-semibold mb-3">åŸºæœ¬æƒ…å ±</h4>
            <div id="customerBasicInfo" class="space-y-2">
              <!-- åŸºæœ¬æƒ…å ±ã¯ JavaScript ã§ç”Ÿæˆ -->
            </div>
          </div>
          
          <div>
            <h4 class="font-semibold mb-3">æ¥åº—å±¥æ­´</h4>
            <div id="customerVisitHistory" class="space-y-2 max-h-64 overflow-y-auto">
              <!-- æ¥åº—å±¥æ­´ã¯ JavaScript ã§ç”Ÿæˆ -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="menuModal" class="modal">
    <div class="bg-white rounded-lg w-full max-w-md mx-4">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900" id="menuModalTitle">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç·¨é›†</h3>
      </div>
      <div class="p-6">
        <form id="menuForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ¡ãƒ‹ãƒ¥ãƒ¼å</label>
            <input type="text" id="menuName" class="w-full px-3 py-2 border border-gray-300 rounded-md" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">æ–™é‡‘</label>
            <input type="number" id="menuPrice" class="w-full px-3 py-2 border border-gray-300 rounded-md" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">æ‰€è¦æ™‚é–“ï¼ˆåˆ†ï¼‰</label>
            <input type="number" id="menuDuration" class="w-full px-3 py-2 border border-gray-300 rounded-md" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">èª¬æ˜</label>
            <textarea id="menuDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md"></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ç”»åƒURL</label>
            <input type="url" id="menuPhotoURL" class="w-full px-3 py-2 border border-gray-300 rounded-md">
          </div>
          <div class="flex space-x-3">
            <button type="button" onclick="closeMenuModal()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600">
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button type="submit" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
              ä¿å­˜
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ã‚¹ã‚¿ãƒƒãƒ•ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="staffModal" class="modal">
    <div class="bg-white rounded-lg w-full max-w-md mx-4">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900" id="staffModalTitle">ã‚¹ã‚¿ãƒƒãƒ•ç·¨é›†</h3>
      </div>
      <div class="p-6">
        <form id="staffForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¹ã‚¿ãƒƒãƒ•å</label>
            <input type="text" id="staffName" class="w-full px-3 py-2 border border-gray-300 rounded-md" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">å½¹è·</label>
            <select id="staffRole" class="w-full px-3 py-2 border border-gray-300 rounded-md">
              <option value="ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆ">ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆ</option>
              <option value="ãƒˆãƒƒãƒ—ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆ">ãƒˆãƒƒãƒ—ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆ</option>
              <option value="ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ">ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</option>
              <option value="åº—é•·">åº—é•·</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">å¾—æ„åˆ†é‡</label>
            <textarea id="staffSpecialty" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md"></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">å†™çœŸURL</label>
            <input type="url" id="staffPhotoURL" class="w-full px-3 py-2 border border-gray-300 rounded-md">
          </div>
          <div class="flex space-x-3">
            <button type="button" onclick="closeStaffModal()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600">
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button type="submit" class="flex-1 bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
              ä¿å­˜
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="counselingModal" class="modal">
    <div class="bg-white rounded-lg w-full max-w-3xl mx-4 max-h-full overflow-y-auto">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900">ğŸ“‹ ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã‚·ãƒ¼ãƒˆ</h3>
      </div>
      <div class="p-6">
        <form id="counselingForm" class="space-y-6">
          <!-- åŸºæœ¬æƒ…å ± -->
          <div>
            <h4 class="font-medium mb-3">åŸºæœ¬æƒ…å ±</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">é«ªè³ª</label>
                <select id="counselingHairType" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆ">ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆ</option>
                  <option value="ã‚¦ã‚§ãƒ¼ãƒ–">ã‚¦ã‚§ãƒ¼ãƒ–</option>
                  <option value="ã‚«ãƒ¼ãƒ«">ã‚«ãƒ¼ãƒ«</option>
                  <option value="ãã›æ¯›">ãã›æ¯›</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">é«ªã®é‡</label>
                <select id="counselingHairVolume" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="å°‘ãªã„">å°‘ãªã„</option>
                  <option value="æ™®é€š">æ™®é€š</option>
                  <option value="å¤šã„">å¤šã„</option>
                </select>
              </div>
            </div>
          </div>

          <!-- é«ªã®æ‚©ã¿ -->
          <div>
            <h4 class="font-medium mb-3">é«ªã®æ‚©ã¿ãƒ»å¸Œæœ›</h4>
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ç¾åœ¨ã®é«ªã®æ‚©ã¿</label>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                  <label class="flex items-center space-x-2">
                    <input type="checkbox" class="hair-concern" value="ãƒ‘ã‚µã¤ã" class="rounded">
                    <span class="text-sm">ãƒ‘ã‚µã¤ã</span>
                  </label>
                  <label class="flex items-center space-x-2">
                    <input type="checkbox" class="hair-concern" value="ã†ã­ã‚Š" class="rounded">
                    <span class="text-sm">ã†ã­ã‚Š</span>
                  </label>
                  <label class="flex items-center space-x-2">
                    <input type="checkbox" class="hair-concern" value="ãƒœãƒªãƒ¥ãƒ¼ãƒ ä¸è¶³" class="rounded">
                    <span class="text-sm">ãƒœãƒªãƒ¥ãƒ¼ãƒ ä¸è¶³</span>
                  </label>
                  <label class="flex items-center space-x-2">
                    <input type="checkbox" class="hair-concern" value="ç™½é«ª" class="rounded">
                    <span class="text-sm">ç™½é«ª</span>
                  </label>
                  <label class="flex items-center space-x-2">
                    <input type="checkbox" class="hair-concern" value="é ­çš®ã®æ‚©ã¿" class="rounded">
                    <span class="text-sm">é ­çš®ã®æ‚©ã¿</span>
                  </label>
                  <label class="flex items-center space-x-2">
                    <input type="checkbox" class="hair-concern" value="ãã®ä»–" class="rounded">
                    <span class="text-sm">ãã®ä»–</span>
                  </label>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">å¸Œæœ›ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«</label>
                <textarea id="counselingDesiredStyle" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md" 
                          placeholder="ã©ã®ã‚ˆã†ãªã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ"></textarea>
              </div>
            </div>
          </div>

          <!-- ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ« -->
          <div>
            <h4 class="font-medium mb-3">ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">æœã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°æ™‚é–“</label>
                <select id="counselingStylingTime" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="5åˆ†ä»¥å†…">5åˆ†ä»¥å†…</option>
                  <option value="10åˆ†ç¨‹åº¦">10åˆ†ç¨‹åº¦</option>
                  <option value="15åˆ†ç¨‹åº¦">15åˆ†ç¨‹åº¦</option>
                  <option value="20åˆ†ä»¥ä¸Š">20åˆ†ä»¥ä¸Š</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ä½¿ç”¨ä¸­ã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°å‰¤</label>
                <input type="text" id="counselingStylingProducts" class="w-full px-3 py-2 border border-gray-300 rounded-md" 
                       placeholder="ä¾‹ï¼‰ãƒ¯ãƒƒã‚¯ã‚¹ã€ãƒ ãƒ¼ã‚¹ã€ã‚ªã‚¤ãƒ«ç­‰">
              </div>
            </div>
          </div>

          <!-- ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãƒ»æ³¨æ„äº‹é … -->
          <div>
            <h4 class="font-medium mb-3">ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãƒ»æ³¨æ„äº‹é …</h4>
            <div class="space-y-3">
              <div>
                <label class="flex items-center space-x-2">
                  <input type="checkbox" id="hasAllergies" class="rounded">
                  <span class="text-sm">ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãŒã‚ã‚‹</span>
                </label>
              </div>
              <div id="allergyDetails" class="hidden">
                <textarea id="counselingAllergies" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md" 
                          placeholder="ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã®è©³ç´°ã‚’ã”è¨˜å…¥ãã ã•ã„"></textarea>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ãã®ä»–æ³¨æ„äº‹é …</label>
                <textarea id="counselingNotes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md" 
                          placeholder="æ–½è¡“æ™‚ã«æ³¨æ„ã™ã¹ãç‚¹ãŒã‚ã‚Œã°ã”è¨˜å…¥ãã ã•ã„"></textarea>
              </div>
            </div>
          </div>

          <div class="flex space-x-3">
            <button type="button" onclick="closeCounselingModal()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600">
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button type="submit" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
              ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ä¿å­˜
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Firebase SDKï¼ˆã‚µãƒ³ãƒ—ãƒ« - å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯Firebaseè¨­å®šãŒå¿…è¦ï¼‰ -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script>
    // ===== Firebase åˆæœŸåŒ–ï¼ˆã‚µãƒ³ãƒ—ãƒ«è¨­å®šï¼‰ =====
    const firebaseConfig = {
      // å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯é©åˆ‡ãªFirebaseè¨­å®šã‚’ä½¿ç”¨
      apiKey: "demo-key",
      authDomain: "demo.firebaseapp.com",
      projectId: "demo-project"
    };
    
    // FirebaseåˆæœŸåŒ–ï¼ˆãƒ‡ãƒ¢ç”¨ã®è¨­å®šï¼‰
    try {
      firebase.initializeApp(firebaseConfig);
      window.db = firebase.firestore();
    } catch (error) {
      console.log('Firebase Demo Mode');
      // ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ç”¨ã®ãƒ¢ãƒƒã‚¯DB
      window.db = {
        collection: () => ({
          get: () => Promise.resolve({ forEach: () => {} }),
          add: () => Promise.resolve({ id: 'demo' + Date.now() }),
          doc: () => ({
            get: () => Promise.resolve({ exists: false, data: () => ({}) }),
            set: () => Promise.resolve(),
            update: () => Promise.resolve(),
            delete: () => Promise.resolve()
          })
        })
      };
    }

    // ===== ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° =====
    let currentTab = 'dashboard';
    let customersData = [];
    let menusData = [];
    let staffsData = [];
    let reservationsData = [];
    let messagesData = [];
    let currentCustomer = null;
    let currentMenu = null;
    let currentStaff = null;
    let selectedChatCustomer = null;

    // ===== åˆæœŸåŒ– =====
    document.addEventListener('DOMContentLoaded', function() {
      initializeData();
      setupEventListeners();
      loadDashboard();
    });

    function initializeData() {
      // ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–
      customersData = [
        {
          id: 'customer1',
          name: 'ç”°ä¸­ èŠ±å­',
          phone: '090-1234-5678',
          totalVisits: 5,
          totalSpent: 25000,
          lastVisit: new Date('2024-11-15'),
          daysSinceLastVisit: 38,
          tags: ['å¸¸é€£é¡§å®¢'],
          birthday: '1990-03-15',
          counseling: {
            hairType: 'ã‚¦ã‚§ãƒ¼ãƒ–',
            hairVolume: 'æ™®é€š',
            concerns: ['ãƒ‘ã‚µã¤ã', 'ã†ã­ã‚Š'],
            desiredStyle: 'ãƒŠãƒãƒ¥ãƒ©ãƒ«ãªãƒœãƒ–ã‚¹ã‚¿ã‚¤ãƒ«',
            completedAt: '2024-10-01'
          },
          reservations: [
            { datetime: '2024-11-15T14:00:00', menu: 'ã‚«ãƒƒãƒˆï¼‹ã‚«ãƒ©ãƒ¼', staff: 'å±±ç”°', price: 8000 },
            { datetime: '2024-09-10T15:30:00', menu: 'ã‚«ãƒƒãƒˆ', staff: 'ç”°ä¸­', price: 5000 }
          ]
        },
        {
          id: 'customer2',
          name: 'ä½è—¤ å¤ªéƒ',
          phone: '080-9876-5432',
          totalVisits: 1,
          totalSpent: 3000,
          lastVisit: new Date('2024-12-01'),
          daysSinceLastVisit: 21,
          tags: ['æ–°è¦é¡§å®¢'],
          birthday: '1985-07-22',
          reservations: [
            { datetime: '2024-12-01T10:00:00', menu: 'ã‚«ãƒƒãƒˆ', staff: 'å±±ç”°', price: 3000 }
          ]
        },
        {
          id: 'customer3',
          name: 'éˆ´æœ¨ ç¾å’²',
          phone: '070-1111-2222',
          totalVisits: 12,
          totalSpent: 80000,
          lastVisit: new Date('2024-08-15'),
          daysSinceLastVisit: 130,
          tags: ['VIPé¡§å®¢', 'é›¢åãƒªã‚¹ã‚¯'],
          birthday: '1988-12-03',
          counseling: {
            hairType: 'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆ',
            hairVolume: 'å¤šã„',
            concerns: ['ç™½é«ª', 'ãƒœãƒªãƒ¥ãƒ¼ãƒ ä¸è¶³'],
            desiredStyle: 'ä¸Šå“ãªãƒŸãƒ‡ã‚£ã‚¢ãƒ ã‚¹